<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Stanstash | Crypto Casino</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}?v=20.0">
</head>
<body>

    <header class="top-navbar">
        <div class="logo-container" onclick="navigate('home')">
            <i class="fa-solid fa-bolt accent-color"></i> <span class="brand-name">STANSTASH</span>
        </div>
        
        <div class="user-panel">
            <div class="guest-view" id="guestNav">
                <button class="btn-login" onclick="openModal('loginModal')">ENTRAR</button>
                <button class="btn-register desktop-only" onclick="openModal('registerModal')">REGISTRO</button>
            </div>
            
            <div class="logged-view hidden" id="loggedNav">
                <div class="balance-pill" onclick="navigate('deposit')">
                    <span id="userBalance">0.00</span> <i class="fa-brands fa-bitcoin"></i>
                    <span class="add-fund-icon"><i class="fa-solid fa-plus"></i></span>
                </div>
                <div class="nav-avatar desktop-only" onclick="navigate('profile')">
                    <img id="navAvatarImg" src="https://cdn.pixabay.com/photo/2015/10/05/22/37/blank-profile-picture-973460_960_720.png" alt="Avatar">
                </div>
            </div>
        </div>
    </header>

    <main class="main-content">
        
        <section id="view-home" class="view-section active">
            <div class="hero-banner">
                <div class="hero-text">
                    <h1>CASINO CRYPTO <br><span class="text-gradient">SIN L√çMITES</span></h1>
                    <p>Retiros Instant√°neos ‚Ä¢ Sin KYC ‚Ä¢ 100% An√≥nimo</p>
                    <button class="btn-cta" onclick="navigate('games')">JUGAR AHORA</button>
                </div>
            </div>
            <div class="live-wins-section">
                <div class="section-header">
                    <div class="live-indicator"><span class="blink"></span> GANADORES EN VIVO</div>
                </div>
                <table class="wins-table">
                    <tbody id="liveWinsBody"></tbody>
                </table>
            </div>
        </section>

        <section id="view-games" class="view-section hidden">
            <div class="games-grid">
                <div class="game-card" onclick="alert('Crash en Mantenimiento')">
                    <div class="live-badge">LIVE</div>
                    <div class="game-poster crash-bg"><i class="fa-solid fa-plane-up"></i></div>
                    <div class="game-details"><h3>Crash</h3><p>Multiplicador x1000</p></div>
                </div>
                <div class="game-card" onclick="alert('Mines en Mantenimiento')">
                    <div class="game-poster mines-bg"><i class="fa-solid fa-bomb"></i></div>
                    <div class="game-details"><h3>Mines</h3><p>Estrategia Pura</p></div>
                </div>
                <div class="game-card locked">
                    <div class="game-poster slots-bg" style="opacity:0.5"><i class="fa-solid fa-lock"></i></div>
                    <div class="game-details"><h3>Slots VIP</h3><p>Pr√≥ximamente</p></div>
                </div>
            </div>
        </section>

        <section id="view-profile" class="view-section hidden">
            <div class="profile-page-container">
                <div class="profile-wrapper">
                    
                    <div class="profile-dashboard-grid">
                        <div class="profile-header-card">
                            <div class="profile-info-row">
                                <div class="profile-avatar-area">
                                    <img id="profileAvatarBig" src="https://cdn.pixabay.com/photo/2015/10/05/22/37/blank-profile-picture-973460_960_720.png">
                                    <label for="avatarInput" class="camera-btn"><i class="fa-solid fa-camera"></i></label>
                                    <input type="file" id="avatarInput" hidden onchange="uploadAvatar()" accept="image/*">
                                </div>
                                <div class="profile-text">
                                    <h3 id="profileUsername">Cargando...</h3>
                                    <span class="user-badge verified"><i class="fa-solid fa-check-circle"></i> Cuenta Verificada</span>
                                </div>
                            </div>
                        </div>

                        <div class="wallet-card">
                            <div class="wallet-header">SALDO DISPONIBLE</div>
                            <div class="wallet-amount" id="profileBalanceDisplay">0.00</div>
                            <div class="wallet-actions">
                                <button class="btn-dep" onclick="navigate('deposit')">Depositar</button>
                                <button class="btn-wd" onclick="alert('Retiros en 24h')">Retirar</button>
                            </div>
                        </div>
                    </div>

                    <div class="settings-list">
                        <div class="settings-item" onclick="togglePasswordEdit()">
                            <div class="set-icon"><i class="fa-solid fa-lock"></i></div>
                            <div class="set-text">Cambiar Contrase√±a</div>
                            <i class="fa-solid fa-chevron-down arrow" id="passChevron"></i>
                        </div>
                        
                        <div id="passwordEditSection" class="password-form hidden">
                            <input type="password" id="currentPass" placeholder="Contrase√±a Actual" class="input-field-sm">
                            <input type="password" id="newPass1" placeholder="Nueva Contrase√±a" class="input-field-sm">
                            <input type="password" id="newPass2" placeholder="Confirmar Nueva" class="input-field-sm">
                            <button class="btn-save-pass" onclick="changePassword()">Guardar Nueva Contrase√±a</button>
                        </div>
                        
                        <div class="settings-item danger" onclick="doLogout()">
                            <div class="set-icon"><i class="fa-solid fa-power-off"></i></div>
                            <div class="set-text">Cerrar Sesi√≥n</div>
                        </div>
                    </div>

                </div>
            </div>
        </section>

        <section id="view-deposit" class="view-section hidden">
            <div class="deposit-page-container">
                <div class="deposit-wrapper">
                    <h2 class="page-title"><i class="fa-solid fa-wallet"></i> A√±adir Fondos</h2>
                    
                    <div id="depositForm">
                        <div class="method-grid">
                            <div class="method-card active"><i class="fa-brands fa-bitcoin"></i><span>Cripto</span><div class="check-mark"><i class="fa-solid fa-check"></i></div></div>
                            <div class="method-card disabled"><i class="fa-solid fa-credit-card"></i><span>Tarjeta</span><small>(Pronto)</small></div>
                        </div>

                        <div class="deposit-box">
                            <label class="input-label">Selecciona Moneda</label>
                            
                            <div class="crypto-scroll-container">
                                <div class="crypto-option selected" id="opt-btc" onclick="selectCrypto('btc')">
                                    <img src="https://cryptologos.cc/logos/bitcoin-btc-logo.png?v=026"> BTC
                                </div>
                                <div class="crypto-option" id="opt-eth" onclick="selectCrypto('eth')">
                                    <img src="https://cryptologos.cc/logos/ethereum-eth-logo.png?v=026"> ETH
                                </div>
                                <div class="crypto-option" id="opt-sol" onclick="selectCrypto('sol')">
                                    <img src="https://cryptologos.cc/logos/solana-sol-logo.png?v=026"> SOL
                                </div>
                                <div class="crypto-option" id="opt-usdt" onclick="selectCrypto('usdt')">
                                    <img src="https://cryptologos.cc/logos/tether-usdt-logo.png?v=026"> USDT
                                </div>
                                <div class="crypto-option" id="opt-trx" onclick="selectCrypto('trx')">
                                    <img src="https://cryptologos.cc/logos/tron-trx-logo.png?v=026"> TRX
                                </div>
                                <div class="crypto-option" id="opt-ltc" onclick="selectCrypto('ltc')">
                                    <img src="https://cryptologos.cc/logos/litecoin-ltc-logo.png?v=026"> LTC
                                </div>
                                <div class="crypto-option" id="opt-doge" onclick="selectCrypto('doge')">
                                    <img src="https://cryptologos.cc/logos/dogecoin-doge-logo.png?v=026"> DOGE
                                </div>
                                <div class="crypto-option" id="opt-xrp" onclick="selectCrypto('xrp')">
                                    <img src="https://cryptologos.cc/logos/xrp-xrp-logo.png?v=026"> XRP
                                </div>
                            </div>

                            <label class="input-label">Monto (USD)</label>
                            <div class="amount-input-group">
                                <span class="currency-symbol">$</span>
                                <input type="number" id="depositAmount" placeholder="50.00" class="amount-field">
                            </div>

                            <button class="btn-pay-now" onclick="createPayment()">GENERAR DIRECCI√ìN</button>
                            <p class="deposit-note">M√≠nimo 10$. Procesado por NOWPayments.</p>
                        </div>
                    </div>

                    <div id="depositWaiting" class="hidden">
                        <div class="deposit-box center-content">
                            <div class="spinner-box"><i class="fa-solid fa-circle-notch fa-spin"></i></div>
                            <h3>Esperando Pago...</h3>
                            <p>Env√≠a <b>exactamente</b> <span id="payAmountDisplay" style="color:#00ff88">0</span> <span id="payCurrencyDisplay">BTC</span> a:</p>
                            
                            <div class="address-box" onclick="copyAddress()">
                                <span id="payAddressDisplay">Generando...</span>
                                <i class="fa-solid fa-copy"></i>
                            </div>
                            
                            <div class="timer-bar"><div class="timer-fill"></div></div>
                            <p class="deposit-note">Detectando transacci√≥n en blockchain... (Simulaci√≥n 5s)</p>
                            <button class="btn-cancel" onclick="cancelPayment()">CANCELAR</button>
                        </div>
                    </div>

                </div>
            </div>
        </section>

    </main>

    <aside class="desktop-sidebar desktop-only">
        <nav class="sidebar-menu">
            <a href="#" onclick="navigate('home')" class="sidebar-item active" id="side-home"><i class="fa-solid fa-house"></i> Inicio</a>
            <a href="#" onclick="navigate('games')" class="sidebar-item" id="side-games"><i class="fa-solid fa-gamepad"></i> Juegos</a>
            <a href="#" onclick="navigate('deposit')" class="sidebar-item" id="side-deposit"><i class="fa-solid fa-wallet"></i> Cartera</a>
            <a href="#" onclick="toggleChat()" class="sidebar-item"><i class="fa-solid fa-comments"></i> Chat Global</a>
            <a href="#" onclick="navigate('profile')" class="sidebar-item" id="side-profile"><i class="fa-solid fa-user"></i> Mi Perfil</a>
        </nav>
        <div class="sidebar-footer hidden" id="desktopLogout">
            <button class="btn-logout-side" onclick="doLogout()"><i class="fa-solid fa-right-from-bracket"></i> Cerrar Sesi√≥n</button>
        </div>
    </aside>

    <nav class="bottom-nav mobile-only">
        <a href="#" onclick="navigate('home')" class="nav-item active" id="nav-home"><i class="fa-solid fa-house"></i><span>Inicio</span></a>
        <a href="#" onclick="navigate('deposit')" class="nav-item" id="nav-deposit"><i class="fa-solid fa-wallet"></i><span>Cartera</span></a>
        <div class="nav-center" onclick="navigate('games')"><i class="fa-solid fa-play"></i></div>
        <a href="#" onclick="toggleChat()" class="nav-item"><i class="fa-solid fa-comments"></i><span>Chat</span></a>
        <a href="#" onclick="navigate('profile')" class="nav-item" id="nav-profile"><i class="fa-solid fa-user"></i><span>Perfil</span></a>
    </nav>

    <div id="chatSidebar" class="chat-sidebar closed">
        <div class="chat-header">
            <h3>Chat Global <span class="online-count">‚óè LIVE</span></h3>
            <button class="btn-close-chat" onclick="toggleChat()"><i class="fa-solid fa-xmark"></i></button>
        </div>
        <div class="chat-messages" id="chatMessages">
            <div class="chat-msg system">
                <div class="sys-text">Bienvenido al chat global.</div>
            </div>
        </div>
        <div class="chat-input-area">
            <input type="text" id="chatInput" placeholder="Escribe un mensaje..." onkeypress="handleChatKeyPress(event)">
            <button class="btn-send-chat" onclick="sendMessage()"><i class="fa-solid fa-paper-plane"></i></button>
        </div>
    </div>

    <div id="loginModal" class="modal hidden">
        <div class="modal-content auth-modal">
             <span class="close" onclick="closeModal('loginModal')">&times;</span>
             <h2>Bienvenido</h2>
             <input type="text" id="loginUser" placeholder="Usuario" class="input-field">
             <input type="password" id="loginPass" placeholder="Contrase√±a" class="input-field">
             <button class="btn-action" onclick="doLogin()">INICIAR SESI√ìN</button>
             <div class="auth-footer"><a onclick="switchModal('loginModal', 'registerModal')">Crear cuenta nueva</a></div>
        </div>
    </div>

    <div id="registerModal" class="modal hidden">
        <div class="modal-content auth-modal">
             <span class="close" onclick="closeModal('registerModal')">&times;</span>
             <h2>Registro</h2>
             <input type="text" id="regUser" placeholder="Usuario" class="input-field">
             <input type="password" id="regPass" placeholder="Contrase√±a" class="input-field">
             <input type="email" id="regEmail" placeholder="Email Real (C√≥digo)" class="input-field">
             <div class="phone-group">
                 <select id="regPrefix" class="input-field prefix"><option value="+34">üá™üá∏ +34</option><option value="+1">üá∫üá∏ +1</option></select>
                 <input type="tel" id="regPhone" placeholder="Tel√©fono" class="input-field phone">
             </div>
             <button class="btn-action" onclick="doRegister()">CREAR CUENTA</button>
             <div class="auth-footer"><a onclick="switchModal('registerModal', 'loginModal')">Ya tengo cuenta</a></div>
        </div>
    </div>

    <div id="verifyModal" class="modal hidden">
        <div class="modal-content auth-modal">
             <h2><i class="fa-solid fa-envelope-circle-check"></i> Verificar Email</h2>
             <p style="color:#aaa; text-align:center; font-size:0.9rem; margin-bottom:20px;">
                 C√≥digo enviado a: <b id="verifyEmailDisplay" style="color:white;">...</b>
             </p>
             <input type="text" id="verifyCodeInput" placeholder="C√≥digo (ej: 123456)" class="input-field" style="text-align:center; letter-spacing:5px; font-size:1.5rem;">
             <button class="btn-action" onclick="doVerify()">VERIFICAR</button>
             <div class="auth-footer"><a onclick="switchModal('verifyModal', 'loginModal')">Volver al login</a></div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.7.2/socket.io.min.js"></script>
    <script src="{{ url_for('static', filename='js/script.js') }}"></script>
</body>
</html>